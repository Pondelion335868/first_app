(function(){if(typeof YJNEWS=="undefined"||!YJNEWS){YJNEWS={}}if(typeof YJNEWS.REALTIME=="undefined"||!YJNEWS.REALTIME){YJNEWS.REALTIME={}}var b="YJNEWS.REALTIME.cb",d=5000,f=5,c='<p class="msg">この記事に一致する情報は見つかりませんでした。</p>',a="http://realtime.search.yahoo.co.jp/search?ei=UTF-8&fr=rts_mod&rkf=1&p=",e="http://rd.yahoo.co.jp/media/news/realtime/more/",h;var g=function(){};g.prototype={callback:b,results:"",eappid:"",query:"",apiUrl:"",setParams:function(i){this.headline=i.headline;this.articleUrl=i.articleUrl;this.eappid=i.eappid;this.results=i.results||f;this.apiUrl=i.apiUrl;if(this.headline.indexOf("“")>=0||this.headline.indexOf("”")>=0){this.query="URL:"+this.articleUrl}else{this.query="URL:"+this.articleUrl+' OR "'+this.headline+'"'}},request:function(){var i=this,j=i.apiUrl+"?"+jQuery.param({query:i.query,callback:b,results:i.results,eappid:i.eappid});h=new JSONscriptRequest(j);h.setCache();h.buildScriptTag();h.addScriptTag()},cb:function(k){var j=this;j.baseTime=k.head.baseTime;if(k.entry.length!==0){$("#realtimeContents").append("<ul>");jQuery.each(k.entry,function(n,o){var m={name:o.author.name,userId:o.author.screenName,screenNameRdUrl:o.author.screenNameRdUrl,imgSrc:o.author.image,imgUrl:o.author.screenNameRdUrl,imgAlt:o.author.name,content:j._getContent(o.content,o.entities),ago:j._getPostTime(o.updated),agoUrl:o.idRdUrl,favoriteUrl:o.favoriteRdUrl,rtUrl:o.rtRdUrl,replyUrl:o.replyRdUrl};var p='<li><p class="tweet">'+m.content+'</p><div class="metadata"><a href="'+m.imgUrl+'"><img class="pict" src="'+m.imgSrc+'" width="48" height="48" alt="'+m.imgAlt+'"><div class="account"><span class="user">'+m.userId+'</span><span class="full">（'+m.name+'）</span></div></a>-<a href="'+m.agoUrl+'" class="time">'+m.ago+'</a></div><div class="action"><a href="'+m.favoriteUrl+'">お気に入り</a>|<a href="'+m.rtUrl+'">リツイート</a>|<a href="'+m.replyUrl+'">返信</a></div></li>';$("#realtimeContents ul").append(p)});var l=e+"*"+a+encodeURIComponent(j.query);var i='<div class="btn"><a href="'+l+'">もっと見る</a></div>';$("div .itemFt").prepend(i)}else{$("#realtimeContents").append(c)}h.removeScriptTag()},_getContent:function(j,k){var i=this;var l=i._sortEntities(k);j=i._contentReplace(j,l);return j},_sortEntities:function(o){var p=[],j,n,m,l,k;for(j in o){switch(j){case"urls":case"hashtags":case"user_mentions":l=o[j].length;for(m=0;m<l;m+=1){n=o[j][m];n.entity=j;p.push(n)}break;default:break}}p.sort(function(q,i){return q.indices[0]-i.indices[0]});return p},_contentReplace:function(t,v){var p=0,s,z,o,x,j,r,y,u,w=[];s=this._getObjectLength(v);if(!s){return t}for(;p<s;p+=1){z=v.shift();switch(z.entity){case"urls":o=z.url;x=z.display_url;j=z.rdUrl;y="";u=o;break;case"hashtags":r="#";o=r+z.text;x="";j=z.rdUrl;y="tag";u="[#＃]"+z.text;break;case"user_mentions":r="@";o=r+z.screen_name;x="";j=z.rdUrl;y="atUser";u="[@＠]"+z.screen_name;break;default:continue}var l=new RegExp(u,"i");l.exec(t);var q=t.match(l);var k;if(q!==null){k=q[0]}if(!x){x=k}var m=t.split(k);var n=m.shift();w.push(n);w.push(this._wrap(x,j,y));t=m.join(k)}w.push(t);return w.join("")},_wrap:function(i,k,j){var l="";j=j||"";l+='<a href="'+k+'"';if(j!==""){l+=' class="'+j+'"'}l+=">"+i+"</a>";return l},_getPostTime:function(i){var l=this._W3CDTFtoDate(this.baseTime),j=this._W3CDTFtoDate(i),k=l.getTime()-j.getTime();if(k<0){k=0}if(k<1000*60){return Math.floor(k/1000)+"秒前"}if(k<1000*60*60){return Math.floor(k/1000/60)+"分前"}if(k<1000*60*60*24){return Math.floor(k/1000/60/60)+"時間前"}return Math.floor(k/1000/60/60/24)+"日前"},_W3CDTFtoDate:function(k){var i=k.match(/(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})/);var j=new Date(i[1],i[2]-1,i[3],i[4],i[5],i[6]);j.setTime(j.getTime()+9*60*60*1000);return j},_getObjectLength:function(l){var k,j=0;for(k in l){j+=1}return j}};YJNEWS.REALTIME=new g()})();