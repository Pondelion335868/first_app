var YJNEWS;if(typeof YJNEWS=="undefined"||!YJNEWS){YJNEWS={}}if(typeof YJNEWS.FB=="undefined"||!YJNEWS.FB){YJNEWS.FB={}}if(typeof YJNEWS.FB.Obj=="undefined"||!YJNEWS.FB.Obj){YJNEWS.FB.Obj={}}if(typeof YJNEWS.Event=="undefined"||!YJNEWS.Event){YJNEWS.Event={}}if(typeof YJNEWS.Util=="undefined"||!YJNEWS.Util){YJNEWS.Util={}}YJNEWS.Util=(function(){var b,a=null;return{jsonp:function(e,c){var d="http://headlines.yahoo.co.jp/sc/show?func="+e+"&callback=YJNEWS.Util.execCallback";a=c;b=new JSONscriptRequest(d);b.buildScriptTag();b.addScriptTag()},execCallback:function(c){a(c);b.removeScriptTag()}}})();YJNEWS.Event=(function(){var a=[];return{init:function(){a=[]},click:function(c,d,b){if(typeof c==="string"){$(c).bind("click",d,b)}else{}},register:function(b){a.push(b)},getEvents:function(){return a}}})();YJNEWS.FB.Obj=(function(h){var n=null,l=null,m=null,k=null,i=null,a=false,b=null,d=null,e=null,g=0;var o=function(q){var q=q||{dispArticleNum:i,flag:a,deviceFlag:b,readModuleFlag:d};i=q.dispArticleNum;a=q.flag;b=q.deviceFlag;d=q.readModuleFlag;return{init:function(){FB.init({appId:"276725822409153",channelUrl:"http://"+document.domain+"/channel",status:true,cookie:true,xfbml:true});if(d){var u=YJNEWS.FB.Obj.APIModel(),t=YJNEWS.FB.Obj.MakeParamModel(),r=YJNEWS.FB.Obj.UserDataModel(),s=YJNEWS.FB.Obj.DataView();FB.getLoginStatus(function(v){if(v.status==="connected"){n=v.authResponse.accessToken;k=v.authResponse.userID;u.fbApi(t.getUserInfo(v),function(w){s.userDataView(r.userData(w))});if(a===true){e=setTimeout(function(){u.fbApi(t.ogp({article:YJNEWS.FB.url}),function(w){})},10000)}YJNEWS.Event.click("#btnDel",null,function(){l=1;u.fbApi(t.readedList(n),function(w){s.readedArticleView(r.readedArticle(w))});return false});if(YJNEWS.FB.spaceId){FB.Event.subscribe("edge.create",function(w){var y=[{mod:{name:"facebook"},links:[{name:"like_log",params:{sec:"facebook",slk:"like_log",pos:"1"}}]}];var x=YAHOO.i13n.Beaconer({beacon_server:"ybx.yahoo.co.jp",keys:{rpdprop:"facebook"},link_data:y,spaceid:YJNEWS.FB.spaceId});if(g===0){x.doClickBeacon(y[0].links[0].params);g=1}})}}else{if(v.status==="not_authorized"){s.userNotAuthorizeView(r.userNotAuthorize())}else{}}})}},cookieSet:function(r){var s="http://headlines.yahoo.co.jp/sc/show?func=set&facebookRead="+r;jsr=new JSONscriptRequest(s);jsr.buildScriptTag();jsr.addScriptTag();jsr.removeScriptTag();(r==="true")?r="on":r="off";var s="http://dailynews.yahoo.co.jp/fc/changeFBCookie.php?auto="+r;jsr=new JSONscriptRequest(s);jsr.buildScriptTag();jsr.addScriptTag();jsr.removeScriptTag()}}};var c=function(){return{fbApi:function(r,s){var q=r;if(q.data){FB.api(q.param,q.reqType,q.data,s)}else{if(q.reqType){FB.api(q.param,q.reqType,s)}else{FB.api(q.param,s)}}}}};var f=function(){return{getUserInfo:function(q){var r={param:{method:"fql.query",query:"SELECT name, profile_url, pic_square FROM user WHERE uid="+q.authResponse.userID}};return r},ogp:function(q){var r={param:"/me/news.reads",reqType:"post",data:q};return r},getFriends:function(q){var r={param:{method:"fql.query",query:"SELECT uid, name, pic_square FROM user WHERE uid in (SELECT uid2 FROM friend WHERE uid1="+q.authResponse.userID+") AND is_app_user = 1"}};return r},readedList:function(q){var r={param:"/me/news.reads?access_token="+q,reqType:"get",data:{offset:0,limit:25}};return r},deleteArticle:function(r){var q={param:"/"+r,reqType:"delete",data:null};return q}}};var p=function(){return{userNotAuthorize:function(){var r="",q;if(b==="pc"){r='<li><a href="#" onclick="" id="tglStart">利用開始</a></li>'}else{if(b==="smp"){r='<li class="status"><a href="#" onclick="" id="tglStart">読んだ記事を自動共有</a></li>'}}q=function(){YJNEWS.Event.click("#tglStart",null,function(){var s="https://www.facebook.com/dialog/oauth/?client_id=276725822409153&redirect_uri="+YJNEWS.FB.url+"&state=fc&scope=publish_actions&display=";if(b==="pc"){s+="page"}else{if(b==="smp"){s+="touch"}}top.location=s;return false})};return{html:r,events:q}},userData:function(q){var t='<a href="'+q[0].profile_url+'"><img src="'+q[0].pic_square+'" width="30" height="30"></a>',v=q[0].name,s=q[0].profile_url,u=0,r=null;u=a;if(u===true){html='<li class="label">自動共有：</li>';html+='<li class="switch"><span class="on">ON</span>';html+='<a href="#" onclick="" id="tglCancel">OFF</a></li>';r=function(){var w="";h("#tglCancel").unbind("click");YJNEWS.Event.click("#tglCancel",null,function(){YJNEWS.FB.Obj.APPCntr().cookieSet("false");clearTimeout(e);w='<li class="label">自動共有：</li>';w+='<li class="switch"><a href="#" onclick="" id="tglStart">ON</a>';w+='<span class="off">OFF</span></a></li>';h("#fb_badge").html(w);h("#tglStart").unbind("click");YJNEWS.Event.click("#tglStart",null,function(){YJNEWS.FB.Obj.APPCntr().cookieSet("true");w='<li class="label">自動共有：</li>';w+='<li class="switch"><span class="on">ON</span>';w+='<a href="#" onclick="" id="tglCancel">OFF</a></li>';YJNEWS.FB.Obj.APIModel().fbApi(YJNEWS.FB.Obj.MakeParamModel().ogp({article:YJNEWS.FB.url}),function(x){});h("#fb_badge").html(w);r();return false});return false})}}else{html='<li class="label">自動共有：</li>';html+='<li class="switch"><a href="#" onclick="" id="tglStart">ON</a>';html+='<span class="off">OFF</span></a></li>';r=function(){var w="";h("#tglStart").unbind("click");YJNEWS.Event.click("#tglStart",null,function(){YJNEWS.FB.Obj.APPCntr().cookieSet("true");w='<li class="label">自動共有：</li>';w+='<li class="switch"><span class="on">ON</span>';w+='<a href="#" onclick="" id="tglCancel">OFF</a></li>';YJNEWS.FB.Obj.APIModel().fbApi(YJNEWS.FB.Obj.MakeParamModel().ogp({article:YJNEWS.FB.url}),function(x){});h("#fb_badge").html(w);h("#tglCancel").unbind("click");YJNEWS.Event.click("#tglCancel",null,function(){YJNEWS.FB.Obj.APPCntr().cookieSet("false");clearTimeout(e);w='<li class="label">自動共有：</li>';w+='<li class="switch"><a href="#" onclick="" id="tglStart">ON</a>';w+='<span class="off">OFF</span></li>';h("#fb_badge").html(w);r();return false});return false})}}return{profilePic:t,username:v,profileUrl:s,html:html,events:r}},readedArticle:function(q){var I="",D="",F="",H="",M="";var y=[],w=0,B=q.data.length,t=B%i,E=B,z=1;var K=q.paging.next,N=q.data,C=N.length,J,L,O,v,G,u;m=(B/i)<<0;if(t!==0){m=m+1}if(m>5){m=5}if(q.data.length){D+="   <!-- .label -->";D+='   <div class="label">';D+='       <p class="labelTitle">最近のアクティビティを削除</p>';D+='       <ul class="pager" id="pagerPrev" style="display:none">';D+='           <li class="prev"><a href="#" onclick="">戻る</a></li><li class="next"><span>進む</span></li>';D+="       </ul>";D+='       <ul class="pager" id="pagerNext" style="display:none">';D+='           <li class="prev"><span>戻る</span></li><li class="next"><a href="#" onclick="">進む</a></li>';D+="       </ul>";D+='       <ul class="pager" id="pagerMiddle" style="display:none">';D+='           <li class="prev"><a href="#" onclick="">戻る</a></li><li class="next"><a href="#" onclick="">進む</a></li>';D+="       </ul>";D+='       <ul class="pager" id="pagerNone" style="display:none">';D+='           <li class="prev"><span>戻る</span></li><li class="next"><span>進む</span></li>';D+="       </ul>";D+="   </div>";D+="   <!-- /.label -->";I+="   <!-- .listRowlink -->";I+='   <div class="listRowlink">';I+="       <ul>";H+="       </ul>";H+="   </div>";H+="   <!-- /.listRowlink -->";M='<a href="http://www.facebook.com/profile.php?id='+k+'&sk=allactivity&log_filter=app_276725822409153">Facebookのアクティビティログへ</a>';for(J=0;C>J;J++){L=N[J].data;if(L.article!==undefined){O=L.article.title;O=O.replace(/ - Y!ニュース( トピックス)?/,"");v=L.article.url;G=N[J].id;u=L.article.id;if(b==="pc"){F+='           <li id="delete'+J+'" class="notSelect">';F+='               <p class="title" id="notDelete'+J+'" style="display:block">';F+='                   <a href="#" onclick="">'+O+"</a>";F+="               </p>";F+='               <p class="title" id="deleted'+J+'" style="display:none">';F+="                   <a>"+O+"</a>";F+="               </p>";F+='               <p id="deleteId'+J+'" style="display:none">'+G+"</p>";F+='               <p class="subText" id="deleteErrorMsg'+J+'" style="display:none">削除に失敗しました。</p>';F+="           </li>"}else{if(b==="smp"){F+='           <li id="delete'+J+'" class="notSelect">';F+='              <a href="#" onclick="" id="notDelete'+J+'" style="display:block">';F+="                   <dl>";F+='                       <dt class="title">'+O+"</dt>";F+='                       <dd id="deleteId'+J+'" style="display:none">'+G+"</dd>";F+='                       <dd class="subText" id="deleteErrorMsg'+J+'" style="display:none">削除に失敗しました。</dd>';F+="                   </dl>";F+="              </a>";F+='              <a id="deleted'+J+'" style="display:none">';F+="                   <dl>";F+='                       <dt class="title">'+O+"</dt>";F+='                       <dd id="deleteId'+J+'" style="display:none">'+G+"</dd>";F+="                   </dl>";F+="              </a>";F+="          </li>"}}}E--;if(z===i||E===0){if(w<5){y[w]=I+F+H;z=1;w++;F=""}}else{z++}}var x=function(){h(".next a").unbind("click");h(".prev a").unbind("click");YJNEWS.Event.click(".next a",null,function(){var Q=l+1,P=null;h("#page"+l).hide();h("#page"+Q).show();h(".pager").css("display","none");l++;if(l===m&&m!==1){P=h("#pagerPrev")}else{if(l===1&&m!==1){P=h("#pagerNext")}else{if(m===1&&m===1){P=h("#pagerNone")}else{P=h("#pagerMiddle")}}}P.css("display","block");return false});YJNEWS.Event.click(".prev a",null,function(){var P=l-1;h("#page"+l).hide();h("#page"+P).show();h(".pager").css("display","none");l--;if(l===m&&m!==1){pager=h("#pagerPrev")}else{if(l===1&&m!==1){pager=h("#pagerNext")}else{if(m===1&&m===1){pager=h("#pagerNone")}else{pager=h("#pagerMiddle")}}}pager.css("display","block");return false})};var s=function(P){h("#btnDelClose").unbind("click");YJNEWS.Event.click("#btnDelClose",{pageNum:P},function(U){var Q=document.getElementById("btnDel"),S=document.getElementById("btnDelClose");if(Q){Q.style.display="block"}if(S){S.style.display="none"}for(var R=0;R<U.data.pageNum;R++){var T=R+1;h("#page"+T).css("display","none")}h("#label").html("");h("#delItemList").css("display","none");return false})};var A=function(R){var Q=null;if(b==="pc"){Q=" p a"}else{if(b==="smp"){Q=" a"}}for(var P=0;R>P;P++){h("#delete"+P+Q).unbind("click");YJNEWS.Event.click("#delete"+P+Q,{i:P},function(T){h("#delete"+T.data.i+Q).unbind("click");YJNEWS.Event.click("#delete"+T.data.i+Q,null,function(){return false});var S=document.getElementById("deleteErrorMsg"+T.data.i),U=document.getElementById("deleteId"+T.data.i).innerHTML;YJNEWS.FB.Obj.APIModel().fbApi(YJNEWS.FB.Obj.MakeParamModel().deleteArticle(U),function(V){if(!V||V.error){S.style.display="block";A()}else{document.getElementById("delete"+T.data.i).className="select";h("#notDelete"+T.data.i).css("display","none");h("#deleted"+T.data.i).css("display","block");h("#delete"+T.data.i+Q).unbind("click");S.style.display="none"}});return false})}};YJNEWS.Event.init();YJNEWS.Event.register({data:C,func:A});YJNEWS.Event.register({data:null,func:x});YJNEWS.Event.register({data:y.length,func:s});return{data:{pageData:y,label:D,activityLog:M},events:YJNEWS.Event.getEvents()}}else{var r=function(P){h("#btnDelClose").unbind("click");YJNEWS.Event.click("#btnDelClose",{pageNum:P},function(U){var Q=document.getElementById("btnDel"),S=document.getElementById("btnDelClose");if(Q){Q.style.display="block"}if(S){S.style.display="none"}for(var R=0;R<U.data.pageNum;R++){var T=R+1;h("#page"+T).css("display","none")}h("#label").html("");h("#delItemList").css("display","none");return false})};D="   <!-- .label -->";D+='   <div class="label">';D+='       <p class="labelTitle">最近のアクティビティを削除</p>';D+="   </div>";F='<div class="listRowlink"><ul><li id="delete1" class="notSelect"><dd class="subText">アクティビティはありません。</dd></li></ul></div>';return{html:F,label:D,events:r}}}}};var j=function(){return{userNotAuthorizeView:function(r){var q=h("#fb_not_authorized");if(q){h("#fb_badge_not_auth").html(r.html);q.show();r.events()}},userDataView:function(q){var r=h("#fb_connected");if(r){h("#account_link").attr("href",q.profileUrl);h("#pict").html(q.profilePic);h("#name").html(q.username);h("#fb_badge").html(q.html);r.show();q.events()}},readedArticleView:function(t){var u,s,x,y,v,w,r=document.getElementById("btnDel"),q=document.getElementById("btnDelClose");if(r){r.style.display="none"}if(q){q.style.display="block"}h("#delItemList").css("display","block");if(typeof t.data=="object"){x=t.events.length,y=t.events,w=t.data.pageData.length;for(u=0;u<w;u++){v=u+1;h("#page"+v).html(t.data.pageData[u])}h("#label").html(t.data.label);if(w===1){h("#pagerNone").show()}else{h("#pagerNext").show()}h("#page1").show();h("#delItemList .linkText").html(t.data.activityLog);for(s=0;s<x;s++){y[s].func(y[s].data)}}else{h("#label").html(t.label).show();h("#page1").html(t.html).show();t.events(1)}},fbCommentsView:function(){var q=0;if(b==="pc"){q=614}else{if(b==="smp"){q=300}}var r='<fb:comments href="'+YJNEWS.FB.url+'" mobile="false" num_posts="'+YJNEWS.FB.numPosts+'" width="'+q+'px"></fb:comments>';h("#FacebookComments").html(r);if(typeof window.FB!=="undefined"){if(YJNEWS.FB.commentLoaded===false){FB.XFBML.parse(document.getElementById("FacebookComments"));if(typeof YJNEWS.FB.initSetting.rdLabelImpFb!=="undefined"){YJNEWS.RD(YJNEWS.FB.initSetting.rdLabelImpFb)}}}YJNEWS.FB.commentLoaded=true}}};return{APPCntr:o,APIModel:c,MakeParamModel:f,UserDataModel:p,DataView:j}})(jQuery);(function(c){var b,e="facebook-jssdk",a=c.getElementsByTagName("script")[0];if(c.getElementById(e)){return}b=c.createElement("script");b.id=e;b.async=true;b.src="//connect.facebook.net/ja_JP/all.js";a.parentNode.insertBefore(b,a)}(document));