var YPA_TI_CLOSE_FLAG=true;var YPA_TARGET_SUBDOMAIN="www.yahoo.co.jp";var YPAcloseImg="http://ai.yimg.jp/bdv/yahoo/images/closead.png";var YPA_TARGET_PATH="/";var YPA_CLOSE_CAP_COOKIE_NAME="RMATICW";var YPA_COOKIE_EXPIRES_DAY=28;var YPAtiElement;var YPAtilElement;var YPAtilImgElement;var YPAtirElement;var YPAtirImgElement;var YPAopenElement;var YPAcloseElement;var YPAtiIO;var YPAtiADID;var YPAcurrentTime;var YPAdisplayFlg;var YPArmaticwCookie;var YPArmaticwKey;var YPAtrhandle;var YPAsessionId=makeSessionID();if(YPAlinkL.indexOf("ace%")!=-1&&window.location.href.indexOf("http")!=-1){YPAlinkL="";YPAlinkR="";YPAtarget="";YPAtrhandle=true;}if(YPA_TI_CLOSE_FLAG){tiMain();}function tiMain(){YPAtilElement=createTopImpactLTag();YPAtirElement=createTopImpactRTag();YPAtiElement=document.getElementById("topImpact");YPAtiElement.appendChild(YPAtilElement);YPAtiElement.appendChild(YPAtirElement);YPAtiIO=encodeBase32(YPAybx.match(/M=(\d+)/)[1]);YPAtiADID=encodeBase32(YPAybx.match(/A=(\d+)/)[1]);YPArmaticwKey=YPAtiIO;YPAcurrentTime=(YPAybx.match(/J=(\d+)/)[1]).substring(0,10);if(!document.cookie){openDisplay();YPAdisplayFlg=true;}else{YPArmaticwCookie=getRmaticwCookie();var oldYPArmaticwCookie=YPArmaticwCookie;removeExpiredCookieValue();YPAdisplayFlg=!checkCloseCap(YPArmaticwKey);if(YPAdisplayFlg){openDisplay();}else{closeDisplay();SendRedirect2Stats(makeNonDisplayBeaconURL());}if(YPArmaticwCookie!=oldYPArmaticwCookie){updateCookie(YPArmaticwCookie);}}YPAtrhandle=false;}function createTopImpactLTag(){var element=document.createElement("div");element.id="topImpactL";element.style.position="absolute";element.style.left="-180px";return element;}function createTopImpactRTag(){var element=document.createElement("div");element.id="topImpactR";element.style.position="absolute";element.style.left="100%";element.style.marginLeft="10px";return element;}function createImgTag(width,height,link){var element=document.createElement("a");element.href=link;element.target="_top";var imgElement=document.createElement("img");imgElement.src="http://ai.yimg.jp/images/clear.gif";imgElement.style.width=width;imgElement.style.height=height;element.appendChild(imgElement);return element;}function createCloseButtonTag(){var element=document.createElement("div");element.id="closeTopImpact";element.style.position="absolute";element.style.left="100%";element.style.margin="6px 0 0 16px";element.style.cursor="pointer";var imgElement=document.createElement("img");imgElement.onclick=toggleDisplay;imgElement.src=YPAcloseImg;imgElement.alt="広告を非表示";element.appendChild(imgElement);return element;}function createOpenButtonTag(){var element=document.createElement("div");element.id="openTopImpact";element.style.position="absolute";element.style.left="100%";element.style.margin="7px 0 0 12px";element.style.fontSize="12px";element.style.textDecoration="underline";element.style.whiteSpace="nowrap";var imgElement=document.createElement("a");imgElement.href="javascript:void(0);";imgElement.onclick=toggleDisplay;imgElement.innerHTML="広告を再表示";element.appendChild(imgElement);return element;}function createButtonTag(id,width,height,imgUrl){var element=document.createElement("a");element.id=id;element.href="javascript:toggleDisplay();";element.style.position="absolute";element.style.top="10px";element.style.left="10px";var imgElement=document.createElement("img");imgElement.src=YPAcloseImg;imgElement.style.width=width;imgElement.style.height=height;element.appendChild(imgElement);return element;}function toggleDisplay(){removeExpiredCookieValue();if(YPAdisplayFlg){closeDisplay();YPAdisplayFlg=false;addCookieValue(YPArmaticwKey);SendRedirect2Stats(makeOpenCloseBeaconURL("close"));}else{openDisplay();YPAdisplayFlg=true;removeCookieValue(YPArmaticwKey);SendRedirect2Stats(makeOpenCloseBeaconURL("expand"));}updateCookie(YPArmaticwCookie);}function closeDisplay(){setDisplayNone(YPAtilImgElement);setDisplayNone(YPAtirImgElement);setDisplayNone(YPAcloseElement);if(YPAopenElement!=null){YPAopenElement.style.display="block";}else{YPAopenElement=createOpenButtonTag();YPAtiElement.appendChild(YPAopenElement);}}function openDisplay(){setDisplayNone(YPAopenElement);if(YPAtilImgElement!=null){YPAtilImgElement.style.display="block";}else{YPAtilImgElement=createImgTag("170px","1024px",YPAlinkL);YPAtilElement.appendChild(YPAtilImgElement);YPAtilElement.style.backgroundImage="url("+YPAtilImg+")";}if(YPAtirImgElement!=null){YPAtirImgElement.style.display="block";}else{YPAtirImgElement=createImgTag("170px","1024px",YPAlinkR);YPAtirElement.appendChild(YPAtirImgElement);YPAtirElement.style.backgroundImage="url("+YPAtirImg+")";}if(YPAcloseElement!=null){YPAcloseElement.style.display="block";}else{YPAcloseElement=createCloseButtonTag();YPAtiElement.appendChild(YPAcloseElement);}}function setDisplayNone(element){if(element!=null){element.style.display="none";}}function checkCloseCap(key){if(!document.cookie){return false;}return checkValidTerm(key);}function checkValidTerm(key){if(YPArmaticwCookie==null||YPArmaticwCookie==""){return false;}var expiredTime=getExpiredTime(key);if(expiredTime===-1){return false;}return(expiredTime>YPAcurrentTime);}function getExpiredTime(key){if(YPArmaticwCookie==null||YPArmaticwCookie==""){return -1;}var time=YPArmaticwCookie.match(new RegExp(key+":e=([^;]*);?"));return(time==null)?-1:decodeBase32(time[1]);}function getRmaticwCookie(){var rmaticw=document.cookie.match(/RMATICW=([^;]*);?/);return(rmaticw==null)?null:decodeURIComponent(rmaticw[1]);}function getRmaticwValueNum(values){var valueArray=values.split(";");return(valueArray==null)?0:valueArray.length;}function addCookieValue(key){var result="";if(YPArmaticwCookie!=null&&YPArmaticwCookie!=""){result=YPArmaticwCookie.replace(new RegExp(key+":e=[^;];?"),"")+";";}result+=key+":e="+encodeBase32(parseInt(YPAcurrentTime)+parseInt(YPAcloseCap));if(getRmaticwValueNum(result)>24){result=result.replace(/^[^;]*;/,"");}YPArmaticwCookie=result;}function removeCookieValue(key){if(YPArmaticwCookie==null||YPArmaticwCookie==""){return;}YPArmaticwCookie=YPArmaticwCookie.replace(new RegExp(key+":e=[^;]*;?"),"");}function removeExpiredCookieValue(){if(YPArmaticwCookie==null||YPArmaticwCookie==""){return;}var valueArray=YPArmaticwCookie.split(";");var result="";for(var i=0;i<valueArray.length;i++){if(valueArray[i]===""||valueArray[i]==null){break;}var key=String(valueArray[i]).match(/^([^:]*):e=/);if(checkValidTerm(key[1])){result+=valueArray[i]+";";}}result=result.slice(0,-1);YPArmaticwCookie=result;}function updateCookie(output){if(output===""||output==null){deleteCookie();}else{writeCookie(output);}}function writeCookie(output){var normalized=removeBothEndSeparator(output);writeToBrowserCookie(formatRmaticw(encodeURIComponent(normalized),getExpiresTime()));}function deleteCookie(){writeToBrowserCookie(formatRmaticw("","Thu, 01 Jan 1970 00:00:00 GMT"));}function writeToBrowserCookie(output){if(output!=null){document.cookie=output;}}function formatRmaticw(value,expires){return YPA_CLOSE_CAP_COOKIE_NAME+"="+value+";domain="+YPA_TARGET_SUBDOMAIN+";path="+YPA_TARGET_PATH+";expires="+expires+";";}function getExpiresTime(){return new Date(parseInt(YPAcurrentTime)*1000+parseInt(YPA_COOKIE_EXPIRES_DAY*24*60*60*1000)).toGMTString();}function encodeBase32(input){return parseInt(input).toString(32);}function decodeBase32(input){return parseInt(input,32);}function removeBothEndSeparator(input){if(input==null||input==""){return input;}var removed=input;removed=(removed.charAt(0)==";")?removed.slice(1):removed;removed=(removed.charAt(removed.length-1)==";")?removed.slice(0,-1):removed;return removed;}function YPArdvoid(){return;}function YPAvoid(){return;}function makeNonDisplayBeaconURL(){if(typeof YPAybx=="undefined"||YPAybx.indexOf("%adid%")!=-1||YPAybx.indexOf("%matchid%")!=-1){return null;}return YPAybx+"&IVaction=action1&IVvisibletime=0&IVactiontime=0&IVsid="+YPAsessionId;}function makeOpenCloseBeaconURL(action){if(typeof YPAybx=="undefined"||YPAybx.indexOf("%adid%")!=-1||YPAybx.indexOf("%matchid%")!=-1){return null;}return YPAybx+"&IVaction="+action+"&IVvisibletime=0&IVactiontime=0&IVsid="+YPAsessionId;}function SendRedirect2Stats(key){if(!YPAtrhandle&&key!=null){var i=new Image();i.onload=function(){YPAvoid();};i.src=key+"&r="+YPAGenrandom(4);}}function YPAGenrandom(n){var fig=Math.pow(10,n);var i=String(Math.floor(Math.random()*fig));while(i.length<n){i="0"+i;}return i;}function makeSessionID(){var n=3;var rnd=String(parseInt(Math.random()*Math.pow(10,n)));var now=+new Date();while(rnd.length<n){rnd="7"+rnd;}var nr=rnd+String(now);return parseInt(nr).toString(32);}