<HTML>
<HEAD>
<META HTTP-EQUIV="content-type" CONTENT="text/html; charset=x-sjis">
<TITLE>ユーザ管理</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000" LEFTMARGIN="0" TOPMARGIN="0" MARGINWIDTH="0" MARGINHEIGHT="0">
<IMG SRC="img/title_a.jpg" USEMAP="#MapA" BORDER="0"><BR> 
    <MAP NAME="MapA"> 
      <AREA SHAPE="rect" COORDS="548,48,612,68" HREF="h_04.html">
      <AREA SHAPE="rect" COORDS="622,48,686,68" HREF="h_04-01.html">
      <AREA SHAPE="rect" COORDS="694,48,758,68" HREF="h_04-03.html">
    </MAP>

　<FONT COLOR="#333399" SIZE="+2"><B>4.2 ユーザ管理</B></FONT><BR><BR>

<BLOCKQUOTE> 

<DL>
<DT> <B> ユーザの変更 </B></DT>
<DD>
&nbsp;&nbsp;ユーザがシステムを利用するためにはユーザ名とパスワードが必要になり, システムを利用するときには必ず, ユーザ名とパスワードによる認証を行うことになります. あるシステムを利用できるときそのシステムに対する <B>アカウント</B> を持つといいます.よって, そのシステムようのユーザ名とパスワードを持っているということになります.また単にユーザ名のことをアカウントという場合もあります.<BR>
&nbsp;&nbsp;与えられたアカウントでログインするとシステムを利用できるようになりますが, さらにそのアカウント毎にアクセス権限が設定されており, 利用できるファイルなどの制限が設定されています. そこで, 状況に応じてユーザの権限(アカウント)を変更する必要があります.アカウントを変更するには<B>su</B>(run a shell with substitute user and group IDs)コマンドを使います. student というアカウントでログインした後 otheruser というアカウントに変更する場合には次のようにします.

<PRE> <TT>	su otheruser		</TT> </PRE>

&nbsp;&nbsp;このコマンドを使って root になることもできます.通常は一般のアカウントで作業を行いますが途中でシステムの設定を変更したいときや, リモートログインで直接 root でログインできないときなどに利用できます.この場合ユーザ名を指定せずに su コマンドを実行します.
<P><P>
<TABLE BORDER=0 BGCOLOR="#CCFF99" CELLPADDING=10 WIDTH=500>
<TD> <PRE> <TT>
[student@localhost student]$ <B>su</B>
Password: <B>********</B>
[root@localhost student]#</TT> </PRE> </TD>
</TABLE>
<P><P>	
&nbsp;&nbsp;この場合 root に変更した後も前のアカウントの環境設定を引き継ぎます.root にアカウントを変更した状態で次のようにして環境変数の <B>PATH</B> を表示してみましょう.
<P>
<TABLE BORDER=0 BGCOLOR="#CCFF99" CELLPADDING=10 WIDTH=500>
<TD> <PRE> <TT>
[root@localhost student]# <B>echo $PATH</B>
/usr/local/bin:/bin:/usr/bin:/usr/X11R6/bin
[root@localhost student]#</TT> </PRE> </TD>
</TABLE>
<P><P>
&nbsp;&nbsp;コマンドなどを実行するときに基本的には / ディレクトリからのコマンドの位置を表すか, またはカレントディレクトリからのコマンドの位置を表さなければ実行できません.しかし, このパスの環境変数にディレクトリを設定しておくとそのディレクトリに存在するコマンドはディレクトリで場所を指定しなくても実行できるようになっています.このときに root から抜けるには <B>exit</B> コマンドを使います.
<P><P>
<TABLE BORDER=0 BGCOLOR="#CCFF99" CELLPADDING=10 WIDTH=500>
<TD> <PRE> <TT>
[root@localhost student]# <B>exit</B>
[root@localhost student]#</TT> </PRE> </TD>
</TABLE>
<P>	
<BR>
一方 <B>-</B> を付けて実行すると環境設定も root の設定に変更されます.
この場合 root を抜けるには <B>logout</B> または <B>exit</B> コマンドを使います.
<P><P>
<TABLE BORDER=0 BGCOLOR="#CCFF99" CELLPADDING=10 WIDTH=500>
<TD> <PRE> <TT>
[student@localhost student]$ <B>su -</B>
Password: <B>********</B>
[root@localhost root]# <B>echo $PATH</B>
/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:
/usr/bin/X11:/usr/X11R6/bin:/root/bin
[root@localhost root]# <B>exit</B>
[student@localhost student]$		</TT> </PRE> </TD>
</TABLE>
			
			<P><P>
			&nbsp;&nbsp;各アカウントはそれぞれ違った権限を持ちます. しかしパスワードが他人に知られてしまうと,そのアカウントの権限で他の人がシステムを利用し, 設定などを変更することができてしまいます. 特に root のパスワードは他人に知られないようにしなければいけません.そこでパスワードは数字や記号を組み合わせた他人には分かりにくいものにする必要があります.また定期的にパスワードを変更することも大切です.<BR>
			&nbsp;&nbsp;パスワードを変更するには <B>passwd</B> コマンドを使います.
			<P><P>
				<TABLE BORDER=0 BGCOLOR="#CCFF99" CELLPADDING=10 WIDTH=500>
					<TD> <PRE> <TT>
[student@localhost student]$ <B>passwd</B>
Changing password for studnet
(current) UNX password: <B>********</B>
New UNIX password: <B>********</B>
Retype new UNIX password: <B>********</B>
passwd: all authentication tokens updated succcessfully
[student@localhost student]$	</TT> </PRE> </TD>
				</TABLE>
			<P><P>
			&nbsp;&nbsp;passwd コマンドは現在のユーザのパスワードを変更します.
				<OL>
				  <LI> (current) UNX password:
				    <BR> 現在設定してあるパスワードを入力します.
				  <LI> New UNIX password:
				    <BR> 新しく設定するパスワードを入力します.
				  <LI> Retype new UNIX password:
				    <BR> 再度新しく設定するパスワードを入力します.
				</OL>
			&nbsp;&nbsp;このときパスワードが単純な場合は他のパスワードにするように警告が表示されます.
		
	</DL>
	<P><P><BR>
	<DL>
	
		<DT> <B> ユーザアカウント </B></DT>
			<DD>
			&nbsp;&nbsp;システムを利用するアカウントを追加するには <B>useradd</B> コマンドを使います.ただし, このコマンドには <B>root 権限</B> が必要になりますので su コマンドで root にアカウントを変更してから実行します.新規にユーザ名 newuser を追加するには次のようにします.
			<P>
				<TABLE BORDER=0 BGCOLOR="#CCFF99" CELLPADDING=10 WIDTH=500>
					<TD> <PRE> <TT>
[student@localhost student]$ <B>su</B>
Password: <B>********</B>
[root@localhost root]# <B>/usr/sbin/useradd newuser</B>
[root@localhost root]#				</TT> </PRE> </TD>
				</TABLE>
				<P><P>
					&nbsp;&nbsp;このコマンドを実行するとユーザ名が追加され, 追加したユーザ名と同じ名前のグループが生成され, 追加されたユーザ名は同名のグループのメンバとして登録されます. また "/home" ディレクトリに同名のディレクトリが作成され, ユーザのホームディレクトリとして登録されます.<P>
					&nbsp;&nbsp;このユーザ名でシステムを利用するには, パスワードを設定しておかなければいけません.パスワードを設定するには <TT>passwd</TT> コマンドにパスワードを設定するユーザ名を指定して実行します.
				<P><P>
						<TABLE BORDER=0 BGCOLOR="#CCFF99" CELLPADDING=10 WIDTH=500>
							<TD> <PRE> <TT>
[root@localhost root]# <B>passwd newuser</B>
Changing password for user newuser
New UNIX password: <B>********</B>
Retype new UNIX password: <B>********</B>
password: all authentication tokens updated successfully
[root@localhost root]# <B>exit</B>
[student@localhost student]$				</TT> </PRE> </TD>
						</TABLE>
				<P><P>
						<OL>
						  <LI> New UNIX password:
						    <BR> 設定するパスワードを入力します
						  <LI> Retype new UNIX password:
						    <BR> 再度設定するパスワードを入力します.
						</OL>

						&nbsp;&nbsp;以上でユーザ名 newuser のアカウントが作成され, システムが利用できるようになります.

					<P><P>

					&nbsp;&nbsp;システムを利用しなくなったアカウントは削除(または利用できない状態に)した方がセキュリティにおいては有効になります.アカウントを削除するには <TT>userdel</TT> コマンドを使います. このコマンドもroot 権限で行います.例えば olduser というアカウントを削除するには次のようにします.
					<P><P>
					<TABLE BORDER=0 BGCOLOR="#CCFF99" CELLPADDING=10 WIDTH=500>
						<TD> <PRE> <TT>
[student@localhost student]$ <B>su</B>
Password: <B>********</B>
[root@localhost root]# <B>/usr/sbin/userdel olduser</B>
[root@localhost root]# <B>exit</B>
[student@localhost student]$				</TT> </PRE> </TD>
					</TABLE>

					<P><P>
					&nbsp;&nbsp;ユーザ情報に関するファイルは "<B>/etc/passwd</B>" です.ユーザの追加や削除を行うとこのファイルに情報が書き込まれます.
					<P><P>
					<TABLE BORDER=0 BGCOLOR="#CCFF99" CELLPADDING=10 width=500>
						<TD> <PRE> <TT>root:x:0:0:root:/root:/bin/bash
bin:x:1:1:bin:/bin:
daemon:x:2:2:daemon:/sbin:
adm:x:3:4:adm:/var/adm:
lp:x:4:7:lp:/var/spool/lpd:
sync:x:5:0:sync:/sbin:/bin/sync
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
halt:x:7:0:halt:/sbin:/sbin/halt
student:x:500:500:student name:/home/student:/bin/bash</TT> </PRE> </TD>
						</TABLE>
					<P><P>
					&nbsp;&nbsp;ユーザ情報は 1 行毎に 1 ユーザの情報が記述されています.設定内容は ":" (コロン)で区切られそれぞれ次のような内容になっています.
					<P><P>
						<TABLE BORDER=0 CELLPADDING="5">
						  <TR>
						  	<TD BGCOLOR="#FFCC99" VALIGN="TOP"> 項目 1 </TD>
						  	<TD BGCOLOR="#CCCC99"> ユーザネーム </TD>
						  </TR>
						  <TR>
						  	<TD BGCOLOR="#FFCC99" VALIGN="TOP"> 項目 2 </TD>
						    <TD BGCOLOR="#CCCC99"> ダミーパスワード </TD>
						  </TR>
						  <TR>
						    <TD BGCOLOR="#FFCC99" VALIGN="TOP"> 項目 3 </TD>
						    <TD BGCOLOR="#CCCC99"> ユーザID </TD>
						  </TR>
						  <TR>
						   <TD BGCOLOR="#FFCC99" VALIGN="TOP"> 項目 4 </TD>
						   <TD BGCOLOR="#CCCC99"> ユーザが所属するグループID </TD>
						  </TR>
						  <TR>
						   <TD BGCOLOR="#FFCC99" VALIGN="TOP"> 項目 5 </TD>
						   <TD BGCOLOR="#CCCC99"> ユーザのフルネーム </TD>
						  </TR>
						  <TR>
						   <TD BGCOLOR="#FFCC99" VALIGN="TOP"> 項目 6 </TD>
						   <TD BGCOLOR="#CCCC99"> ユーザのホームディレクトリ </TD>
						  </TR>
						  <TR>
						   <TD BGCOLOR="#FFCC99" VALIGN="TOP"> 項目 7 </TD>
						   <TD BGCOLOR="#CCCC99"> ユーザが利用するシェル </TD>
						   </TR>						  
						</TABLE>
						<P><P>
			&nbsp;&nbsp;例えば student というユーザを見てみると次のような事が分かります.
				<UL>
				  <LI> ユーザID - 500
				  <LI> グループ ID - 500
				  <LI> ユーザのフルネーム - studnet name
				  <LI> ユーザのホームディレクトリ - /home/student
				  <LI> ユーザが利用するシェル - /bin/bash
				</UL>
				<P>
			&nbsp;&nbsp;このファイルの各アカウントの情報の 2 番目の項目はダミーパスワードになっています. 最近はセキュリティ上の問題から別の一般ユーザからは見ることができないファイルに記述されています.実際にパスワードが登録されているファイルは "<B>/etc/shadow</B>" というファイルです.このファイルの中身は次のようになっています.ただしファイルの中身を見ることができるのは root のみです.
			<P><P>
					<TABLE BORDER=0 BGCOLOR="#CCFF99" CELLPADDING=10 WIDTH=500>
						<TD> <PRE><TT>
root:bsYv2I6:11571:0:99999:7:-1:-1:0
bin:*:11571:0:99999:7:::
daemon:*:11571:0:99999:7:::
adm:*:11571:0:99999:7:::
lp:*:11571:0:99999:7:::
sync:*:11571:0:99999:7:::
shutdown:*:11571:0:99999:7:::
halt:*:11571:0:99999:7:::
student:2pEQ1CrI:11670:0:99999:7:-1:-1:0	</TT></PRE> </TD>
					</TABLE>
					<P>
&nbsp;&nbsp;このファイルの情報も 1 行に 1 ユーザの情報が記述され, 設定内容は ":" (コロン)で区切られ,それぞれ次のような内容になっています.
<P>
<TABLE BORDER=0 CELLPADDING="5">
<TR> 
  <TD BGCOLOR="#FFCC99" VALIGN="TOP"> 項目 1 </TD>
  <TD BGCOLOR="#CCCC99"> ユーザ名 </TD>
</TR>
<TR>
  <TD BGCOLOR="#FFCC99" VALIGN="TOP"> 項目 2 </TD>
  <TD BGCOLOR="#CCCC99"> 暗号化されたパスワード </TD>
</TR>
<TR>
  <TD BGCOLOR="#FFCC99" VALIGN="TOP"> 項目 3 </TD>
  <TD BGCOLOR="#CCCC99"> パスワードが更新された日(1970年1月1日からの日数) </TD>
</TR>
<TR>
  <TD BGCOLOR="#FFCC99" VALIGN="TOP"> 項目 4 </TD>
  <TD BGCOLOR="#CCCC99"> パスワードが変更できるようになるまでの日数
  <!--- <br> passwd コマンドの -n オプションで設定可---></TD>
</TR>
<TR>
  <TD BGCOLOR="#FFCC99" VALIGN="TOP"> 項目 5 </TD>
  <TD BGCOLOR="#CCCC99"> パスワードが無効になるまでの日数
  <!---<br> passwd コマンドの -x オプションで設定可---></TD>
</TR>
<TR>
  <TD BGCOLOR="#FFCC99" VALIGN="TOP"> 項目 6 </TD>
  <TD BGCOLOR="#CCCC99"> パスワードの期限切れを通知する日(期限切れの日からの日数)
  <!--- <br> passwd コマンドの -w オプションで設定可---> </TD>
</TR>
<TR> 
  <TD BGCOLOR="#FFCC99" VALIGN="TOP"> 項目 7 </TD>
  <TD BGCOLOR="#CCCC99"> パスワードが期限切れになってからそのユーザが使えなくなるまでの日数
  <!---<br> passwd コマンドの -i オプションで設定可---></TD>
</TR>
<TR>
  <TD BGCOLOR="#FFCC99" VALIGN="TOP"> 項目 8 </TD>
  <TD BGCOLOR="#CCCC99"> アカウントが利用できなくなる日(1970年1月1日からの日数)
  <!---<br> passwd コマンドの -i オプションで設定可---> </TD> 
</TR>
<TR>
  <TD BGCOLOR="#FFCC99" VALIGN="TOP"> 項目 9 </TD> 
  <TD BGCOLOR="#CCCC99"> 未使用 </TD> 
</TR>
</TABLE>
<P><P>
&nbsp;&nbsp;例えばユーザ名 student の設定は次のようになっています.
				<OL>
				  <LI> パスワードは 1970年1月1日から数えて 11670 日目に変更
				  <LI> パスワードは現時点で変更可能
				  <LI> パスワードの有効期限はあと 99999 日(有効期限なし)
				  <LI> パスワードの有効期限が切れる 7 日前に通知
				  <LI> パスワードが無効になってもアカウントが利用可(-1)
				  <LI> アカウントの利用期限はなし(-1)
				</OL>
			<P>	
			&nbsp;&nbsp;このファイルにはパスワードの情報も入っていますが, <B>MD5</B> という暗号方式を使って暗号化されているのでここに記述されているパスワード情報からユーザのパスワードを知ることはできないようになっています.そこでパスワードを忘れてしまった場合は root 権限を持つユーザにパスワードを変更してもらうしかありません.<BR>
			&nbsp;&nbsp;これらのユーザ情報が記述されているファイルは直接編集することができません. 編集するには<B><TT>vipw</TT></B> というコマンドを使います. もちろんこのコマンドを実行するためには root 権限が必要です.<BR>
&nbsp;&nbsp;ファイルの編集はエディタ vi と同様の操作で行います.
</DL>


</BLOCKQUOTE> 

<BR><BR><BR>

</BODY>
</HTML>
